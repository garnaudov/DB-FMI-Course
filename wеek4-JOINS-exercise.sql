--I. За базата от данни Movies
USE movies;
--1. Напишете заявка, която извежда името на продуцента и имената на
--филмите, продуцирани от продуцента на филма ‘Star Wars’.

SELECT m.title, me.name
FROM movie m
JOIN movieexec me ON m.producerc# = me.cert#
WHERE me.cert# IN (
	SELECT producerc#
	FROM movie m
	WHERE m.title = 'Star Wars'
);

--2. Напишете заявка, която извежда имената на продуцентите на филмите, в
--които е участвал ‘Harrison Ford’.

--3. Напишете заявка, която извежда името на студиото и имената на
--актьорите, участвали във филми, произведени от това студио, подредени
--по име на студио.

SELECT DISTINCT m.studioname, s.starname
FROM movie m
LEFT JOIN starsin s --using left join because we want to see also the studios without starnames starring in their movies
ON m.title = s.movietitle AND m.year = s.movieyear
ORDER BY m.studioname, s.starname;


--4. Напишете заявка, която извежда имената на актьорите, участвали във
--филми на продуценти с най-големи нетни активи.

--5. Напишете заявка, която извежда имената на актьорите, които не са
--участвали в нито един филм.

SELECT m.name FROM moviestar m
EXCEPT
SELECT s.starname FROM starsin s

--or /using join/

SELECT m.name
FROM moviestar m
LEFT JOIN starsin s ON s.starname = m.name
WHERE s.starname IS NULL

--II. За базата от данни PC
--1. Напишете заявка, която извежда производител, модел и тип на продукт
--за тези производители, за които съответният продукт не се продава
--(няма го в таблиците PC, Laptop или Printer)
--2. Намерете всички производители, които правят както лаптопи, така и
--принтери.
--3. Намерете размерите на тези твърди дискове, които се появяват в два
--или повече модела лаптопи.
--4. Намерете всички модели персонални компютри, които нямат регистриран
--производител.
--III. За базата от данни SHIPS
--1. Напишете заявка, която извежда цялата налична информация за всеки
--кораб, включително и данните за неговия клас. В резултата не трябва да
--се включват тези класове, които нямат кораби.
--2. Повторете горната заявка, като този път включите в резултата и
--класовете, които нямат кораби, но съществуват кораби със същото име
--като тяхното.
--3. За всяка страна изведете имената на корабите, които никога не са
--участвали в битка.
--4. Намерете имената на всички кораби с поне 7 оръдия, пуснати на вода
--през 1916, но наречете резултатната колона Ship Name.
--5. Изведете имената на всички потънали в битка кораби, името и дата на
--провеждане на битките, в които те са потънали. Подредете резултата по
--име на битката.
--6. Намерете името, водоизместимостта и годината на пускане на вода на
--всички кораби, които имат същото име като техния клас.
--7. Намерете всички класове кораби, от които няма пуснат на вода нито един
--кораб.
--8. Изведете името, водоизместимостта и броя оръдия на корабите,
--участвали в битката ‘North Atlantic’, а също и резултата от битката.